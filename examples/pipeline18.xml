<PIPELINE>
	<MODULE seq="001" name="FILE PROCESSING">
		<FUNCTION name="LOAD FILE">
			<REGEXP>(.*)DAPI(.*)</REGEXP>
			<OUTPUT>IMAGE1</OUTPUT>
		</FUNCTION>
	</MODULE>
    <MODULE seq="002" name="FILE PROCESSING">
		<FUNCTION name="CROP IMAGE">
			<INPUT>IMAGE1</INPUT>
			<WINDOW_WIDTH>800</WINDOW_WIDTH>
			<WINDOW_HEIGHT>600</WINDOW_HEIGHT>
			<COORDINATES_X>500</COORDINATES_X>
			<COORDINATES_Y>500</COORDINATES_Y>
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>YOU CROPPED ME!</WINDOWSNAME>
			<OUTPUT>IMAGE2</OUTPUT>
		</FUNCTION>
	</MODULE>
	<MODULE seq="003" name="FILE PROCESSING">
		<FUNCTION name="NORMALIZE">
			<INPUT>IMAGE2</INPUT>
			<OUTPUT>NUCLEI</OUTPUT>
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>NULL</WINDOWSNAME>
			<!-- MAXMIN or LOG-->
			<TYPE>LOG</TYPE>
		</FUNCTION>
	</MODULE>
	 <MODULE seq="004" name="IMAGE PROCESSING">
		<FUNCTION name="ADAPTATIVE THRESHOLD">
			<INPUT>NUCLEI</INPUT>			
			<THRESHOLD_TYPE>BINARY</THRESHOLD_TYPE>
			<METHOD>GAUSSIAN</METHOD>
			<CONSTANT>-0.001</CONSTANT>
			<BLOCKSIZE>31</BLOCKSIZE>
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>THRESHOLD</WINDOWSNAME>
			<OUTPUT>NUC_T</OUTPUT>
		</FUNCTION>
	</MODULE>
    <MODULE seq="005" name="IMAGE PROCESSING">
		<FUNCTION name="MAKE BRUSH">
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>MY BRUSH</WINDOWSNAME>
			<BRUSH_SIZE_X>2</BRUSH_SIZE_X>
			<BRUSH_SIZE_Y>2</BRUSH_SIZE_Y>
			<BRUSH_TYPE>BOX_SHAPE</BRUSH_TYPE>
			<SIGMA>0</SIGMA>
			<OUTPUT>BRUSH NUMBER 1</OUTPUT>
		</FUNCTION>
	</MODULE>
	<MODULE seq="006" name="IMAGE PROCESSING">
		<FUNCTION name="ERODE">
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>EROSION</WINDOWSNAME>
			<INPUT>NUC_T</INPUT>
			<BRUSH>BRUSH NUMBER 1</BRUSH>
			<ITERATIONS>2</ITERATIONS>
			<OUTPUT>NUC_END</OUTPUT>
		</FUNCTION>
	</MODULE>
	<MODULE seq="007" name="IMAGE PROCESSING">
		<FUNCTION name="MAKE BRUSH">
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>MY BRUSH</WINDOWSNAME>
			<BRUSH_SIZE_X>2</BRUSH_SIZE_X>
			<BRUSH_SIZE_Y>2</BRUSH_SIZE_Y>
			<BRUSH_TYPE>ELLIPSE_SHAPE</BRUSH_TYPE>
			<SIGMA>0</SIGMA>
			<OUTPUT>BRUSH NUMBER 2</OUTPUT>
		</FUNCTION>
	</MODULE>
	<MODULE seq="008" name="IMAGE PROCESSING">
		<FUNCTION name="DILATE">
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>DILATE</WINDOWSNAME>
			<INPUT>NUC_END</INPUT>
			<BRUSH>BRUSH NUMBER 2</BRUSH>
			<ITERATIONS>1</ITERATIONS>
			<OUTPUT>NUC_END2</OUTPUT>
		</FUNCTION>
	</MODULE>
	<MODULE seq="009" name="SEGMENTATION PROCESSING">
		<FUNCTION name="LABEL">
			<INPUT>NUC_END2</INPUT>
			<OUTPUT>NUC_OBJ</OUTPUT>
		</FUNCTION>
	</MODULE>
	<MODULE seq="010" name="FILE PROCESSING">
		<FUNCTION name="PAINT OBJECTS">
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>Painted</WINDOWSNAME>
			<INPUT_1>NUCLEI</INPUT_1>
			<COLOUR>RANDOM</COLOUR>
			<THICKNESS>0</THICKNESS>
			<LOAD_OBJECTS>NUC_OBJ</LOAD_OBJECTS>
			<PAINT_CONTOURS>FALSE</PAINT_CONTOURS>
			<WIDTH>800</WIDTH>
			<HEIGHT>600</HEIGHT>
			<OUTPUT>IMAGEX2</OUTPUT>
		</FUNCTION>
	</MODULE>  
	<MODULE seq="011" name="FILE PROCESSING">
		<FUNCTION name="LOAD FILE">
			<REGEXP>(.*)FITC(.*)</REGEXP>
			<OUTPUT>IMAGEB</OUTPUT>
		</FUNCTION>
	</MODULE>
	<MODULE seq="012" name="FILE PROCESSING">
		<FUNCTION name="CROP IMAGE">
			<INPUT>IMAGEB</INPUT>
			<WINDOW_WIDTH>800</WINDOW_WIDTH>
			<WINDOW_HEIGHT>600</WINDOW_HEIGHT>
			<COORDINATES_X>500</COORDINATES_X>
			<COORDINATES_Y>500</COORDINATES_Y>
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>YOU CROPPED ME!</WINDOWSNAME>
			<OUTPUT>IMCROP</OUTPUT>
		</FUNCTION>
	</MODULE>
	<MODULE seq="013" name="FILE PROCESSING">
		<FUNCTION name="NORMALIZE">
			<INPUT>IMCROP</INPUT>
			<OUTPUT>BODIES</OUTPUT>
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>NULL</WINDOWSNAME>
			<!-- MAXMIN or LOG-->
			<TYPE>LOG</TYPE>
		</FUNCTION>
	</MODULE>
   	<MODULE seq="014" name="IMAGE PROCESSING">
		<FUNCTION name="ADAPTATIVE THRESHOLD">
			<INPUT>BODIES</INPUT>			
			<THRESHOLD_TYPE>BINARY</THRESHOLD_TYPE>
			<METHOD>GAUSSIAN</METHOD>
			<CONSTANT>-0.001</CONSTANT>
			<BLOCKSIZE>31</BLOCKSIZE>
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>BODIEs THRESHOLD</WINDOWSNAME>
			<OUTPUT>MASK_BIN</OUTPUT>
		</FUNCTION>
	</MODULE>
	<MODULE seq="015" name="IMAGE PROCESSING">
		<FUNCTION name="MORPHOLOGICAL OPERATION">
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>OPENING BOD</WINDOWSNAME>
			<INPUT>MASK_BIN</INPUT>
			<OPERATION>OPENING</OPERATION>
			<BRUSH>BRUSH NUMBER 1</BRUSH>
			<ITERATIONS>1</ITERATIONS>
			<OUTPUT>MASK</OUTPUT>
		</FUNCTION>
	</MODULE> 
	<MODULE seq="016" name="SEGMENTATION PROCESSING">
		<FUNCTION name="PROPAGATE">
			<SEEDS>NUC_OBJ</SEEDS>
			<INPUT>BODIES</INPUT>
			<MASK>MASK</MASK>
			<SAVE_OBJ>BODIES_OBJ</SAVE_OBJ>
			<LAMBDA>0.0002</LAMBDA>
		</FUNCTION>
	</MODULE> 
	<MODULE seq="017" name="FILE PROCESSING">
		<FUNCTION name="PAINT OBJECTS">
			<ASHOW>FALSE</ASHOW>
			<WINDOWSNAME>Painted bodies</WINDOWSNAME>
			<INPUT>BODIES</INPUT>
			<COLOUR>RANDOM</COLOUR>
			<THICKNESS>0</THICKNESS>
			<LOAD_OBJECTS>BODIES_OBJ</LOAD_OBJECTS>
			<PAINT_CONTOURS>TRUE</PAINT_CONTOURS>
			<OUTPUT>IMAGE_BODIES</OUTPUT>
			<WIDTH>800</WIDTH>
			<HEIGHT>600</HEIGHT>
		</FUNCTION>
	</MODULE> 
	<MODULE seq="018" name="COMPUTE FEATURES">
		<FUNCTION name="FILTER OBJECTS">
			<LOAD_OBJECTS>BODIES_OBJ</LOAD_OBJECTS>
			<!-- FILTERING CAN BE DONE BY SIZE OR DIAMETER -->
			<!-- MAXIMUM == 0 for not having higher threshold-->
			<BY> SIZE </BY>
			<MINIMUM>1</MINIMUM>
			<MAXIMUM>0</MAXIMUM>
			<SAVE_OBJECTS>BODIES_FILTERED</SAVE_OBJECTS>
		</FUNCTION>
	</MODULE> 
	 <MODULE seq="019" name="COMPUTE FEATURES">
		<FUNCTION name="BASIC">
			<LOAD_OBJECTS>BODIES_FILTERED</LOAD_OBJECTS>
			<REFERENCE>BODIES</REFERENCE>
			<MEAN>TRUE</MEAN>
			<SD>TRUE</SD>
			<MAD>TRUE</MAD>
			<QUANTILES>TRUE</QUANTILES>
			<SAVE_INDIVIDUAL>TRUE</SAVE_INDIVIDUAL>
			<FOUTPUT>FEAT_BASIC</FOUTPUT>
			<APPEND_ORIGINAL_NAME>FALSE</APPEND_ORIGINAL_NAME>
			<APPEND_DATE>TRUE</APPEND_DATE>
		</FUNCTION>
	</MODULE> 
	<MODULE seq="020" name="COMPUTE FEATURES">
		<FUNCTION name="SHAPE">
			<LOAD_OBJECTS>BODIES_FILTERED</LOAD_OBJECTS>
			<REFERENCE>BODIES</REFERENCE>
			<AREA>TRUE</AREA>
			<PERIMETER>TRUE</PERIMETER>
			<RADIUS>TRUE</RADIUS>
			<ROUNDNESS>TRUE</ROUNDNESS>
			<SAVE_INDIVIDUAL>TRUE</SAVE_INDIVIDUAL>
			<FOUTPUT>FEAT_BASIC</FOUTPUT>
			<APPEND_ORIGINAL_NAME>FALSE</APPEND_ORIGINAL_NAME>
			<APPEND_DATE>TRUE</APPEND_DATE>
		</FUNCTION>
	</MODULE> 
	<MODULE seq="021" name="COMPUTE FEATURES">
		<FUNCTION name="MOMENT">
			<LOAD_OBJECTS>BODIES_FILTERED</LOAD_OBJECTS>
			<REFERENCE>BODIES</REFERENCE>
			<CENTROID>TRUE</CENTROID>
			<AXIS>TRUE</AXIS>
			<ECCENTRICITY>TRUE</ECCENTRICITY>
			<THETA>TRUE</THETA>
			<SAVE_INDIVIDUAL>TRUE</SAVE_INDIVIDUAL>
			<FOUTPUT>FEAT_BASIC</FOUTPUT>
			<APPEND_ORIGINAL_NAME>FALSE</APPEND_ORIGINAL_NAME>
			<APPEND_DATE>TRUE</APPEND_DATE>
		</FUNCTION>
	</MODULE> 
</PIPELINE>
